pub fn test() {
    test_value = {t = ""; for a in 0..30 { v = "a "; if a > 2 { break } t += v; }; t};
    assert(
        test_value == "a a a ",
        "Test failed {test_value} != \"a a a \""
    );
}
fn test() {#block_1:void
  __work_1:text(1) = "";
  t:text(1) = "";
  test_value:text["t"](1) = {#block_2:text["t"]
    t:text(1) = "";
    {#For block_3:void
      a#index:integer(3) = OpConvIntFromNull();
      loop {#For loop_4
        a:integer(4) = {#Iter range_5:integer
          a#index:integer(3) = if OpNot(OpConvBoolFromInt(a#index)) 0i32 else OpAddInt(a#index, 1i32);
          if OpGeInt(a#index, 30i32) break(0) else null;
          a#index;
        }#Iter range_5:integer;
        {#block_6:void
          v:text(6) = "a ";
          if OpGtInt(a, 2i32) {#block_7:void
            OpFreeText(v);
            break(0);
          }#block_7:void else null;
          OpAppendText(t, v);
          OpFreeText(v);
        }#block_6:void;
      }#For loop_4;
    }#For block_3:void;
    t;
  }#block_2:text["t"];
  if OpEqText(test_value, "a a a ") null else OpPanic({#Formatted string_8:text
    __work_1:text(1) = "Test failed ";
    OpFormatText(__work_1, test_value, 0i32, -1i32, 32i32);
    OpAppendText(__work_1, " != "a a a "");
    __work_1;
  }#Formatted string_8:text);
  OpFreeText(test_value);
  OpFreeText(t);
  OpFreeText(__work_1);
}#block_1:void

byte-code for for_break:test() [1168]
   0[4]: return-address
   0[8]: Text() var=__work_1[8]:text
   1[32]: Text() var=t[32]:text
   2[56]: Text() var=test_value[56]:text["t"]
   3[80]: ClearText(var[32]) var=t[32]:text
   6[80]: ConstText(_value="") -> text
   8[96]: AppendText(var[32], v1: text)
  11[80]: ConvIntFromNull() -> integer var=a#index[80]:integer
  12[84]: VarInt(var[80]) -> integer var=a#index[80]:integer
  15[88]: ConvBoolFromInt(v1: integer) -> boolean
  16[85]: Not(v1: boolean) -> boolean
  17[85]: GotoFalseWord(jump=28, if_false: boolean)
  20[84]: ConstInt(val=0) -> integer
  25[88]: GotoWord(jump=37)
  28[84]: VarInt(var[80]) -> integer var=a#index[80]:integer
  31[88]: ConstInt(val=1) -> integer
  36[92]: AddInt(v1: integer, v2: integer) -> integer
  37[88]: PutInt(var[80], value: integer)
  40[84]: VarInt(var[80]) -> integer var=a#index[80]:integer
  43[88]: ConstInt(val=30) -> integer
  48[92]: GeInt(v1: integer, v2: integer) -> boolean
  49[85]: GotoFalseWord(jump=55, if_false: boolean)
  52[84]: GotoWord(jump=108)
  55[84]: VarInt(var[80]) -> integer var=a#index[80]:integer
  58[88]: Text() var=v[88]:text
  59[112]: ConstText(_value="a ") -> text
  63[128]: AppendText(var[88], v1: text)
  66[112]: VarInt(var[84]) -> integer var=a[84]:integer
  69[116]: ConstInt(val=2) -> integer
  74[120]: GtInt(v1: integer, v2: integer) -> boolean
  75[113]: GotoFalseWord(jump=88, if_false: boolean)
  78[112]: FreeText(var[88])
  81[112]: FreeStack(value=0, discard=28)
  85[84]: GotoWord(jump=108)
  88[112]: VarText(var[88]) -> text var=v[88]:text
  91[128]: AppendText(var[32], v1: text)
  94[112]: FreeText(var[88])
  97[112]: FreeStack(value=0, discard=24)
 101[88]: FreeStack(value=0, discard=4)
 105[84]: GotoWord(jump=12)
 108[84]: FreeStack(value=0, discard=4)
 112[80]: VarText(var[32]) -> text var=t[32]:text
 115[96]: AppendText(var[56], v1: text)
 118[80]: VarText(var[56]) -> text var=test_value[56]:text["t"]
 121[96]: ConstText(_value="a a a ") -> text
 129[112]: EqText(v1: text, v2: text) -> boolean
 130[81]: GotoFalseWord(jump=136, if_false: boolean)
 133[80]: GotoWord(jump=190)
 136[80]: ClearText(var[8]) var=__work_1[8]:text
 139[80]: ConstText(_value="Test failed ") -> text
 153[96]: AppendText(var[8], v1: text)
 156[80]: VarText(var[56]) -> text var=test_value[56]:text["t"]
 159[96]: ConstInt(val=0) -> integer
 164[100]: FormatText(var[8], val: text, width: integer, dir=-1, token=32)
 169[80]: ConstText(_value=" != "a a a "") -> text
 183[96]: AppendText(var[8], v1: text)
 186[80]: VarText(var[8]) -> text var=__work_1[8]:text
 189[96]: Panic(message: text)
 190[80]: FreeText(var[56])
 193[80]: FreeText(var[32])
 196[80]: FreeText(var[8])
 199[80]: Return(ret=0, value=0, discard=76)

Execute test:
    0:[8] Text()
    1:[32] Text()
    2:[56] Text()
    3:[80] ClearText(var[32])
    6:[80] ConstText(_value="") -> ""[80]
    8:[96] AppendText(var[32], v1=""[80])
   11:[80] ConvIntFromNull() -> -2147483648[80]
   12:[84] VarInt(var[80]) -> -2147483648[84]
   15:[88] ConvBoolFromInt(v1=-2147483648[84]) -> false[84]
   16:[85] Not(v1=false[84]) -> true[84]
   17:[85] GotoFalseWord(jump=1196, if_false=true[84])
   20:[84] ConstInt(val=0) -> 0[84]
   25:[88] GotoWord(jump=1205)
   37:[88] PutInt(var[80], value=0[84])
   40:[84] VarInt(var[80]) -> 0[84]
   43:[88] ConstInt(val=30) -> 30[88]
   48:[92] GeInt(v1=0[84], v2=30[88]) -> false[84]
   49:[85] GotoFalseWord(jump=1223, if_false=false[84])
   55:[84] VarInt(var[80]) -> 0[84]
   58:[88] Text()
   59:[112] ConstText(_value="a ") -> "a "[112]
   63:[128] AppendText(var[88], v1="a "[112])
   66:[112] VarInt(var[84]) -> 0[112]
   69:[116] ConstInt(val=2) -> 2[116]
   74:[120] GtInt(v1=0[112], v2=2[116]) -> false[112]
   75:[113] GotoFalseWord(jump=1256, if_false=false[112])
   88:[112] VarText(var[88]) -> "a "[112]
   91:[128] AppendText(var[32], v1="a "[112])
   94:[112] FreeText(var[88])
   97:[112] FreeStack(value=0, discard=24)
  101:[88] FreeStack(value=0, discard=4)
  105:[84] GotoWord(jump=1180)
   12:[84] VarInt(var[80]) -> 0[84]
   15:[88] ConvBoolFromInt(v1=0[84]) -> true[84]
   16:[85] Not(v1=true[84]) -> false[84]
   17:[85] GotoFalseWord(jump=1196, if_false=false[84])
   28:[84] VarInt(var[80]) -> 0[84]
   31:[88] ConstInt(val=1) -> 1[88]
   36:[92] AddInt(v1=0[84], v2=1[88]) -> 1[84]
   37:[88] PutInt(var[80], value=1[84])
   40:[84] VarInt(var[80]) -> 1[84]
   43:[88] ConstInt(val=30) -> 30[88]
   48:[92] GeInt(v1=1[84], v2=30[88]) -> false[84]
   49:[85] GotoFalseWord(jump=1223, if_false=false[84])
   55:[84] VarInt(var[80]) -> 1[84]
   58:[88] Text()
   59:[112] ConstText(_value="a ") -> "a "[112]
   63:[128] AppendText(var[88], v1="a "[112])
   66:[112] VarInt(var[84]) -> 1[112]
   69:[116] ConstInt(val=2) -> 2[116]
   74:[120] GtInt(v1=1[112], v2=2[116]) -> false[112]
   75:[113] GotoFalseWord(jump=1256, if_false=false[112])
   88:[112] VarText(var[88]) -> "a "[112]
   91:[128] AppendText(var[32], v1="a "[112])
   94:[112] FreeText(var[88])
   97:[112] FreeStack(value=0, discard=24)
  101:[88] FreeStack(value=0, discard=4)
  105:[84] GotoWord(jump=1180)
   12:[84] VarInt(var[80]) -> 1[84]
   15:[88] ConvBoolFromInt(v1=1[84]) -> true[84]
   16:[85] Not(v1=true[84]) -> false[84]
   17:[85] GotoFalseWord(jump=1196, if_false=false[84])
   28:[84] VarInt(var[80]) -> 1[84]
   31:[88] ConstInt(val=1) -> 1[88]
   36:[92] AddInt(v1=1[84], v2=1[88]) -> 2[84]
   37:[88] PutInt(var[80], value=2[84])
   40:[84] VarInt(var[80]) -> 2[84]
   43:[88] ConstInt(val=30) -> 30[88]
   48:[92] GeInt(v1=2[84], v2=30[88]) -> false[84]
   49:[85] GotoFalseWord(jump=1223, if_false=false[84])
   55:[84] VarInt(var[80]) -> 2[84]
   58:[88] Text()
   59:[112] ConstText(_value="a ") -> "a "[112]
   63:[128] AppendText(var[88], v1="a "[112])
   66:[112] VarInt(var[84]) -> 2[112]
   69:[116] ConstInt(val=2) -> 2[116]
   74:[120] GtInt(v1=2[112], v2=2[116]) -> false[112]
   75:[113] GotoFalseWord(jump=1256, if_false=false[112])
   88:[112] VarText(var[88]) -> "a "[112]
   91:[128] AppendText(var[32], v1="a "[112])
   94:[112] FreeText(var[88])
   97:[112] FreeStack(value=0, discard=24)
  101:[88] FreeStack(value=0, discard=4)
  105:[84] GotoWord(jump=1180)
   12:[84] VarInt(var[80]) -> 2[84]
   15:[88] ConvBoolFromInt(v1=2[84]) -> true[84]
   16:[85] Not(v1=true[84]) -> false[84]
   17:[85] GotoFalseWord(jump=1196, if_false=false[84])
   28:[84] VarInt(var[80]) -> 2[84]
   31:[88] ConstInt(val=1) -> 1[88]
   36:[92] AddInt(v1=2[84], v2=1[88]) -> 3[84]
   37:[88] PutInt(var[80], value=3[84])
   40:[84] VarInt(var[80]) -> 3[84]
   43:[88] ConstInt(val=30) -> 30[88]
   48:[92] GeInt(v1=3[84], v2=30[88]) -> false[84]
   49:[85] GotoFalseWord(jump=1223, if_false=false[84])
   55:[84] VarInt(var[80]) -> 3[84]
   58:[88] Text()
   59:[112] ConstText(_value="a ") -> "a "[112]
   63:[128] AppendText(var[88], v1="a "[112])
   66:[112] VarInt(var[84]) -> 3[112]
   69:[116] ConstInt(val=2) -> 2[116]
   74:[120] GtInt(v1=3[112], v2=2[116]) -> true[112]
   75:[113] GotoFalseWord(jump=1256, if_false=true[112])
   78:[112] FreeText(var[88])
   81:[112] FreeStack(value=0, discard=28)
   85:[84] GotoWord(jump=1276)
  108:[84] FreeStack(value=0, discard=4)
  112:[80] VarText(var[32]) -> "a a a "[80]
  115:[96] AppendText(var[56], v1="a a a "[80])
  118:[80] VarText(var[56]) -> "a a a "[80]
  121:[96] ConstText(_value="a a a ") -> "a a a "[96]
  129:[112] EqText(v1="a a a "[80], v2="a a a "[96]) -> true[80]
  130:[81] GotoFalseWord(jump=1304, if_false=true[80])
  133:[80] GotoWord(jump=1358)
  190:[80] FreeText(var[56])
  193:[80] FreeText(var[32])
  196:[80] FreeText(var[8])
  199:[80] Return(ret=4294967295[4], value=0, discard=76)
Finished
