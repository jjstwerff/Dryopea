Type 17:Area[5]:
    height:short<0,true>[0]
    terrain:byte<0,true>[2]
    water:byte<0,true>[3]
    direction:byte<0,true>[4]

Type 18:short<0,true>[2]:Short(0, true)

Type 19:byte<0,true>[1]:Byte(0, true)

Type 20:main_vector<Area>[8]:
    vector:vector<Area>[4]

Type 21:vector<Area>[4]:Vector(17)

fn main() {#block(1):void
  __ref_1(1):ref(main_vector<Area>) = null;
  __work_2(1):text = "";
  __work_1(1):text = "";
  [9] OpDatabase(__ref_1(1), 20i32);
  map(1):vector<ref(Area)>["__ref_1"] = OpGetField(__ref_1(1), 4i32, 21i32);
  OpSetInt(__ref_1(1), 4i32, 0i32);
  _elm_1(1):ref(Area)["map"] = OpNewRecord(map(1), 21i32, 65535i32);
  OpSetShort(_elm_1(1), 0i32, 0i32, 0i32);
  OpSetByte(_elm_1(1), 2i32, 0i32, 1i32);
  OpSetByte(_elm_1(1), 3i32, 0i32, 1i32);
  OpSetByte(_elm_1(1), 4i32, 0i32, 1i32);
  OpFinishRecord(map(1), _elm_1(1), 21i32, 65535i32);
  OpAppendCopy(map(1), 16i32, 21i32);
  [10] if OpEqText({#Formatted string(2):text["__work_1"]
    __work_1(1):text = "";
    OpFormatDatabase(__work_1(1), OpGetVector(map(1), 5i32, 3i32), 17i32, false);
    __work_1(1);
  }#Formatted string(2):text["__work_1"], "{height:0,terrain:1,water:1,direction:1}") null else OpPanic({#Formatted string(3):text["__work_2"]
    __work_2(1):text = "record ";
    OpFormatDatabase(__work_2(1), OpGetVector(map(1), 5i32, 3i32), 17i32, false);
    __work_2(1);
  }#Formatted string(3):text["__work_2"]);
  OpFreeRef(__ref_1(1));
  OpFreeText(__work_1(1));
  OpFreeText(__work_2(1));
}#block(1):void

byte-code for tests/suite/08-struct.lav:main()
   0[0]: return-address
   0[4]: ConvRefFromNull() -> ref(reference) var=__ref_1[4]:ref(main_vector<Area>)
   1[16]: Text() var=__work_2[16]:text
   2[40]: Text() var=__work_1[40]:text
   3[64]: [9] Database(var[4], db_tp=20) type=main_vector<Area>[8]:{vector:vector<Area>[4]}[20]
   8[64]: VarRef(var[4]) -> ref(reference) type=main_vector<Area>[8]:{vector:vector<Area>[4]}[20] var=__ref_1[4]:ref(main_vector<Area>)
  11[76]: GetField(v1: ref(reference), fld=4) -> ref(reference) type=vector<Area>[4]:Vector(17)[21]
  14[76]: VarRef(var[4]) -> ref(reference) type=main_vector<Area>[8]:{vector:vector<Area>[4]}[20] var=__ref_1[4]:ref(main_vector<Area>)
  17[88]: ConstInt(val=0) -> integer
  22[92]: SetInt(v1: ref(reference), fld=4, val: integer)
  25[76]: VarVector(var[64]) -> vector type=vector<Area>[4]:Vector(17)[21] var=map[64]:vector<ref(Area)>["__ref_1"]
  28[88]: NewRecord(data: ref(reference), parent_tp=21, fld=65535) -> ref(reference)
  33[88]: VarRef(var[76]) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17] var=_elm_1[76]:ref(Area)["map"]
  36[100]: ConstInt(val=0) -> integer
  41[104]: SetShort(v1: ref(reference), fld=0, min=0, val: integer)
  46[88]: VarRef(var[76]) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17] var=_elm_1[76]:ref(Area)["map"]
  49[100]: ConstInt(val=1) -> integer
  54[104]: SetByte(v1: ref(reference), fld=2, min=0, val: integer)
  59[88]: VarRef(var[76]) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17] var=_elm_1[76]:ref(Area)["map"]
  62[100]: ConstInt(val=1) -> integer
  67[104]: SetByte(v1: ref(reference), fld=3, min=0, val: integer)
  72[88]: VarRef(var[76]) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17] var=_elm_1[76]:ref(Area)["map"]
  75[100]: ConstInt(val=1) -> integer
  80[104]: SetByte(v1: ref(reference), fld=4, min=0, val: integer)
  85[88]: VarVector(var[64]) -> vector type=vector<Area>[4]:Vector(17)[21] var=map[64]:vector<ref(Area)>["__ref_1"]
  88[100]: VarRef(var[76]) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17] var=_elm_1[76]:ref(Area)["map"]
  91[112]: FinishRecord(data: ref(reference), rec: ref(reference), parent_tp=21, fld=65535)
  96[88]: VarVector(var[64]) -> vector type=vector<Area>[4]:Vector(17)[21] var=map[64]:vector<ref(Area)>["__ref_1"]
  99[100]: ConstInt(val=16) -> integer
 104[104]: AppendCopy(data: ref(reference), count: integer, tp=21)
 107[88]: [10] ClearText(var[40]) var=__work_1[40]:text
 110[88]: ConstText(_value="") -> text
 112[104]: VarVector(var[64]) -> vector type=vector<Area>[4]:Vector(17)[21] var=map[64]:vector<ref(Area)>["__ref_1"]
 115[116]: ConstInt(val=3) -> integer
 120[120]: GetVector(r: vector, size=5, index: integer) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17]
 123[116]: FormatDatabase(var[40], val: ref(reference), db_tp=17, pretty=false)
 129[104]: VarText(var[40]) -> text var=__work_1[40]:text
 132[120]: FreeStack(value=16, discard=32)
 136[104]: ConstText(_value="{height:0,terrain:1,water:1,direction:1}") -> text
 178[120]: EqText(v1: text, v2: text) -> boolean
 179[89]: GotoFalseWord(jump=185, if_false: boolean)
 182[88]: GotoWord(jump=221)
 185[88]: ClearText(var[16]) var=__work_2[16]:text
 188[88]: ConstText(_value="record ") -> text
 197[104]: AppendText(var[16], v1: text)
 200[88]: VarVector(var[64]) -> vector type=vector<Area>[4]:Vector(17)[21] var=map[64]:vector<ref(Area)>["__ref_1"]
 203[100]: ConstInt(val=3) -> integer
 208[104]: GetVector(r: vector, size=5, index: integer) -> ref(reference) type=Area[5]:{height:short<0,true>[0], terrain:byte<0,true>[2], water:byte<0,true>[3], direction:byte<0,true>[4]}[17]
 211[100]: FormatDatabase(var[16], val: ref(reference), db_tp=17, pretty=false)
 217[88]: VarText(var[16]) -> text var=__work_2[16]:text
 220[104]: Panic(message: text)
 221[88]: VarRef(var[4]) -> ref(reference) type=main_vector<Area>[8]:{vector:vector<Area>[4]}[20] var=__ref_1[4]:ref(main_vector<Area>)
 224[100]: FreeRef(v1: ref(reference))
 225[88]: FreeText(var[40])
 228[88]: FreeText(var[16])
 231[88]: Return(ret=0, value=0, discard=88)

